/*
 *  jQuery Bookmarklet - v0.1.0
 *  jQuery plugin to make bookmarklets from JavaScript files.
 *  http://michaelbrooks.github.io/jquery-bookmarklet
 *
 *  Made by Michael Brooks
 *  Under MIT License
 */
!function(a,b,c,d){function e(b,c){this.element=b,this.$element=a(this.element);var d=a.extend({},{gist_id:this.$element.data("bookmarklet-gist-id"),gist_filename:this.$element.data("bookmarklet-gist-filename"),raw:this.$element.data("bookmarklet-raw")});this.settings=a.extend({},g,d,c),this._defaults=g,this._name=f,this.init()}var f="bookmarklet",g={gist_api_url:"https://api.github.com/gists/",gist_id:d,gist_filename:d,raw:d,on_ready:d},h={gist:function(){var b=this.settings.gist_id,c=this.settings.gist_api_url,d=this.settings.gist_filename;return a.getJSON(c+b).then(function(a){var b;if(d)b=a.files[d];else{if(1!==Object.keys(a.files).length)throw"Gist contains multiple files. Use 'gist_filename' setting to specify.";b=a.files[Object.keys(a.files)[0]]}return b.content})},raw:function(){return a.ajax({url:this.settings.raw,dataType:"text"})}};e.prototype={init:function(){var a,b=this;if(this.settings.raw)a=h.raw.call(this);else{if(!this.settings.gist_id)throw"Bookmarklet settings must include either 'gist_id' or 'raw'.";a=h.gist.call(this)}a.done(function(a){b.$element.attr("href",b.build_url(a)),b.settings.on_ready&&b.settings.on_ready(b.$element)}).fail(function(a){throw a})},build_url:function(a){return"javascript:"+encodeURIComponent(a)}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))}),this}}(jQuery,window,document);